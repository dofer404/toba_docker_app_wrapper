#!/usr/bin/env bash

DIRBIN=`dirname $0`
DIRPROY=$DIRBIN/..
DIRAPP=$DIRPROY/app
DIRBD=$DIRPROY/bd

#app
DOCKERCOMPOSEFILE_NAME=docker-compose.yml
DOCKERCOMPOSEFILE=$DIRAPP/$DOCKERCOMPOSEFILE_NAME
COMPOSERFILE_NAME=composer.json
COMPOSERFILE=$DIRAPP/$COMPOSERFILE_NAME
ARCHIVO_TOBA_BASES_INI_BACKUP="$DIRBIN/aux/bases_BAK.ini"
ARCHIVO_TOBA_BASES_INI_APP="$DIRAPP/instalacion/bases.ini"
ARCHIVO_TOBA_BASES_INI_READY="$DIRBIN/aux/bases.ini"
#bd
CREARBDFILE_NAME=bd_app_crear.sql
CREARSCHFILE_NAME=bd_app_crear_esquema.sql
CREARBDTOBAFILE_SQL_NAME=bd_toba_crear.sql

CREARBDFILE=$DIRBD/$CREARBDFILE_NAME
CREARSCHFILE=$DIRBD/$CREARSCHFILE_NAME
CREARBDTOBAFILE_SQL=$DIRBD/$CREARBDTOBAFILE_SQL_NAME

#app
cp $DIRBIN/aux/$DOCKERCOMPOSEFILE_NAME $DOCKERCOMPOSEFILE
cp $DIRBIN/aux/$COMPOSERFILE_NAME $COMPOSERFILE
#bd
cp $DIRBIN/aux/$CREARBDTOBAFILE_SQL_NAME $CREARBDTOBAFILE_SQL
cp $DIRBIN/aux/$CREARBDFILE_NAME $CREARBDFILE
cp $DIRBIN/aux/$CREARSCHFILE_NAME $CREARSCHFILE

if [ -f $ARCHIVO_TOBA_BASES_INI_BACKUP ];
then
  cp $ARCHIVO_TOBA_BASES_INI_BACKUP $ARCHIVO_TOBA_BASES_INI_APP
  rm $ARCHIVO_TOBA_BASES_INI_BACKUP
else
  if [ -f $ARCHIVO_TOBA_BASES_INI_READY ];
  then
    rm $ARCHIVO_TOBA_BASES_INI_READY
    if [ -f $ARCHIVO_TOBA_BASES_INI_APP ];
    then
      rm $ARCHIVO_TOBA_BASES_INI_APP
    fi
  fi
fi
